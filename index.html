<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tesla —(1ère STMG)</title>

<!-- Leaflet CSS (carte) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<!-- Styles : design soigné, responsive, thème Tesla -->
<style>
  :root{
    --bg1:#0b0f12;    /* dark */
    --bg2:#111418;    /* slightly lighter */
    --accent:#e82127; /* Tesla red */
    --accent-2:#00c49a;
    --card:#0f1720;
    --muted:#9aa3ab;
    --white:#fff;
    --radius:12px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;background: linear-gradient(180deg,var(--bg1) 0%, #0f2230 100%);color:var(--white);-webkit-font-smoothing:antialiased;}
  a{color:var(--accent);text-decoration:none}
  a:hover{text-decoration:underline}

  /* Top nav with logo */
  header.topbar{
    position:fixed;top:0;left:0;right:0;height:72px;display:flex;align-items:center;gap:18px;padding:0 22px;background:linear-gradient(90deg, rgba(3,6,8,0.6), rgba(3,6,8,0.3));backdrop-filter: blur(6px);z-index:1000;
    border-bottom:1px solid rgba(255,255,255,0.03);
  }
  .brand {display:flex;align-items:center;gap:12px;}
  .brand img{height:44px;width:auto;border-radius:6px;box-shadow:0 6px 18px rgba(232,33,39,0.08)}
  .brand h1{font-size:18px;margin:0;font-weight:600;letter-spacing:0.4px;color:var(--white)}
  nav.main {display:flex; gap:10px; margin-left:28px; flex-wrap:wrap;}
  nav.main a{padding:8px 12px;border-radius:8px;color:rgba(255,255,255,0.9);font-weight:600;font-size:14px;}
  nav.main a:hover{background:rgba(255,255,255,0.03);color:var(--accent)}
  .cta-right{margin-left:auto;display:flex;gap:10px;align-items:center}
  .btn {background:var(--accent);color:white;padding:8px 14px;border-radius:9px;border:none;cursor:pointer;font-weight:700}
  .ghost {background:transparent;border:1px solid rgba(255,255,255,0.06);padding:7px 12px;border-radius:9px;color:#ddd;cursor:pointer}

  /* Sections (diapos) */
  main{padding-top:92px;} /* leave space for header */
  section.slide{
    min-height:calc(100vh - 92px);
    padding:56px 28px;
    display:flex;flex-direction:column;align-items:center;justify-content:center;gap:18px;
  }
  .container{max-width:1100px;width:100%;}

  /* hero */
  .hero{
    display:grid;grid-template-columns:1fr 420px;gap:28px;align-items:center;
  }
  .hero .lead{font-size:20px;color:#dbe7ee;line-height:1.6}
  .hero .meta{margin-top:12px;color:var(--muted);font-size:14px}
  .team-row{display:flex;gap:10px;align-items:center;margin-top:18px}
  .team-photo{width:64px;height:64px;border-radius:50%;object-fit:cover;border:3px solid rgba(255,255,255,0.06);}

  /* content block */
  .card{background:linear-gradient(180deg,#091016, #071219);padding:20px;border-radius:var(--radius);box-shadow:0 12px 40px rgba(2,6,10,0.6);width:100%}
  .card h2{margin:0 0 12px 0}
  .card p{color:#cfe6ef}

  /* images and gallery */
  .gallery{display:flex;flex-wrap:wrap;gap:12px;justify-content:center}
  .gallery img{width:220px;height:140px;object-fit:cover;border-radius:10px;cursor:pointer;border:2px solid rgba(255,255,255,0.03);}

  /* tabs for models */
  .tabs{display:flex;gap:8px;margin-bottom:18px;flex-wrap:wrap}
  .tab-btn{background:rgba(255,255,255,0.03);padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700}
  .tab-btn.active{background:var(--accent);color:#fff;box-shadow:0 8px 24px rgba(232,33,39,0.14)}

  .tab-panel{display:none;background:linear-gradient(180deg,#061017,#07111a);padding:18px;border-radius:10px;color:#dfeef6}
  .tab-panel.active{display:block}
  .tab-panel .specs{display:flex;gap:18px;flex-wrap:wrap;align-items:center;justify-content:center}

  /* table */
  table.clean{width:100%;border-collapse:collapse;background:linear-gradient(180deg,#0b1418, #071014);border-radius:12px;overflow:hidden;color:#e6f7fb}
  table.clean th, table.clean td{padding:12px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:center}
  table.clean th{background:rgba(232,33,39,0.06);font-weight:700}

  /* map and charts */
  #map{height:420px;border-radius:10px;overflow:hidden}
  .charts{display:flex;gap:18px;flex-wrap:wrap;justify-content:center;margin-top:12px}
  canvas{background:linear-gradient(180deg,#071219,#061016);border-radius:10px;padding:8px}

  /* modal */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.75);z-index:2000}
  .modal .box{background:#071018;padding:18px;border-radius:12px;width:90%;max-width:900px}
  .modal .box img{width:100%;border-radius:8px}
  .close-x{position:absolute;top:18px;right:18px;background:rgba(255,255,255,0.06);border-radius:8px;padding:6px 8px;color:#fff;cursor:pointer}

  /* footer */
  footer.sitefoot{padding:28px;text-align:center;color:#cbdbe3;background:linear-gradient(180deg,#061216,#051018);margin-top:36px}
  footer.sitefoot a{color:#9fe3d1}

  /* responsive */
  @media (max-width:980px){
    .hero{grid-template-columns:1fr}
    .brand h1{display:none}
    nav.main{display:none}
  }
</style>
</head>
<body>

<!-- Header / navbar -->
<header class="topbar" role="banner">
  <div class="brand" aria-label="brand">
    <img src="tesla_logo.jpg" alt="Logo Tesla" />
    <div>
      <h1>Projet : Tesla — 1ère STMG</h1>
      <div style="font-size:12px;color:var(--muted)">Mohammed • Dragos • Kely • Noah — 1ère STMG</div>
    </div>
  </div>

  <nav class="main" role="navigation" aria-label="Main navigation">
    <a href="#intro">Intro</a>
    <a href="#histoire">Histoire</a>
    <a href="#organisation">Organisation</a>
    <a href="#tailles">Chiffres</a>
    <a href="#modeles">Modèles</a>
    <a href="#usines">Usines</a>
    <a href="#conclusion">Conclusion</a>
    <a href="#sources">Sources</a>
  </nav>

  <div class="cta-right">
    <button class="ghost" onclick="window.print()">Imprimer</button>
    <button class="btn" onclick="document.querySelector('#modeles').scrollIntoView({behavior:'smooth'})">Voir modèles</button>
  </div>
</header>

<main>

  <!-- INTRO (hero) -->
  <section id="intro" class="slide" aria-labelledby="intro-title">
    <div class="container hero">
      <div>
        <div style="display:flex;align-items:center;gap:12px">
          <div style="background:linear-gradient(90deg,#071018,#0b1b1f);padding:18px;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,0.45);">
            <img src="tesla_logo.jpg" alt="Tesla logo" style="height:84px;display:block">
          </div>
          <div>
            <h2 id="intro-title" style="margin-bottom:6px">Tesla — Vision & Innovation</h2>
            <div class="lead" style="color:#d8eef6">
              Présentation de l’entreprise Tesla : histoire, organisation, chiffres clés, modèles emblématiques, Gigafactories et vision pour le futur.
            </div>
            <div class="meta">Projet réalisé par <strong>Mohammed, Dragos, Kely & Noah</strong> — 1ère STMG — Année 2025</div>
          </div>
        </div>

        <div style="margin-top:18px">
          <button class="btn" onclick="document.getElementById('histoire').scrollIntoView({behavior:'smooth'})">Commencer la présentation</button>
          <button class="ghost" onclick="document.getElementById('sources').scrollIntoView({behavior:'smooth'})" style="margin-left:10px">Voir sources</button>
        </div>

        <div class="team-row" style="margin-top:20px">
          <img src="mohammed.jpg" alt="Mohammed" class="team-photo" title="Mohammed">
          <img src="dragos.jpg" alt="Dragos" class="team-photo" title="Dragos">
          <img src="kely.jpg" alt="Kely" class="team-photo" title="Kely">
          <img src="noah.jpg" alt="Noah" class="team-photo" title="Noah">
        </div>
      </div>

      <div>
        <div class="card">
          <h3 style="color:#e7fbf7">Pitch oral (ce que vous direz)</h3>
          <p>Bonjour à tous — aujourd'hui nous vous présentons Tesla, une entreprise américaine fondée en 2003 et devenue un acteur majeur de la mobilité électrique et de l'énergie propre. Nous couvrirons l'histoire, les modèles, les usines, les chiffres clés et la mission de l'entreprise.</p>

          <ul style="color:#cfeff1;margin-top:12px;text-align:left">
            <li><strong>Dates-clés</strong> : 2008 (Roadster), 2012 (Model S), 2015 (Tesla Energy), 2023 (Cybertruck)</li>
            <li><strong>Mission</strong> : Accélérer la transition mondiale vers une énergie durable</li>
            <li><strong>Zones</strong> : USA, Chine, Europe (Gigafactories)</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- HISTOIRE -->
  <section id="histoire" class="slide">
    <div class="container">
      <div class="card">
        <h2>Histoire & évolution</h2>

        <p style="color:#d6eef3">
          Tesla voit le jour en 2003 avec l’objectif de montrer que les véhicules électriques peuvent être supérieurs aux véhicules à combustion. L’arrivée du Roadster en 2008 a confirmé la faisabilité d’un véhicule électrique sportif. En 2012, la Model S a changé les standards : autonomie, confort et logiciel embarqué.
        </p>

        <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:18px;justify-content:center">
          <img src="roadster.jpg" alt="Roadster" style="width:240px;height:140px;object-fit:cover;border-radius:10px" />
          <img src="modelS.jpg" alt="Model S" style="width:240px;height:140px;object-fit:cover;border-radius:10px" />
          <img src="model3.jpg" alt="Model 3" style="width:240px;height:140px;object-fit:cover;border-radius:10px" />
        </div>

        <p style="color:#d6eef3;margin-top:14px">
          Par la suite Tesla a diversifié ses activités : production de solutions de stockage (Powerwall), panneaux solaires (Solar Roof) et développement de fonctionnalités logicielles (Autopilot, Full Self Driving). La sortie du Cybertruck en 2023 a montré la capacité de Tesla à créer de l’attention médiatique et à oser des designs radicalement nouveaux.
        </p>
      </div>
    </div>
  </section>

  <!-- ORGANISATION -->
  <section id="organisation" class="slide">
    <div class="container">
      <div class="card">
        <h2>Organisation & Structure</h2>
        <p style="color:#d6eef3">
          Tesla est une Société Anonyme cotée au Nasdaq (TSLA). L’entreprise fonctionne avec un conseil d’administration, un management centralisé et une forte mise en avant du PDG Elon Musk. Tesla combine équipes R&D, design, logiciel, fabrication et opérations commerciales pour maintenir une boucle rapide d'innovation.
        </p>

        <div style="display:flex;gap:12px;align-items:center;justify-content:center;margin-top:18px">
          <img src="elon.jpg" alt="Elon Musk" style="width:160px;height:160px;object-fit:cover;border-radius:12px" />
          <div style="text-align:left;max-width:640px;margin-left:6px">
            <p style="color:#cfeef1"><strong>Rôle clé :</strong> Elon Musk incarne la vision publique. Il agit comme moteur stratégique, facilitant levées de fonds, communication et pilotage des priorités produits.</p>
            <p style="color:#cfeef1"><strong>Culture :</strong> approche "first principles", cadence élevée, tolérance aux risques et focus sur l'intégration verticale (fabrication + software).</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CHIFFRES -->
  <section id="tailles" class="slide">
    <div class="container">
      <div class="card">
        <h2>Chiffres clés & performance</h2>
        <p style="color:#d6eef3">Tesla a connu une montée en puissance rapide : effectifs, ventes et chiffre d’affaires ont explosé ces dernières années.</p>

        <table class="clean" style="margin-top:12px">
          <tr><th>Indicateur</th><th>Valeur</th></tr>
          <tr><td>Effectif (2024 estim.)</td><td>~140 000</td></tr>
          <tr><td>Chiffre d'affaires (2023)</td><td>96 milliards $</td></tr>
          <tr><td>Véhicules livrés (2023)</td><td>~1,8 million</td></tr>
          <tr><td>Capitalisation</td><td>~700 milliards $ (variable)</td></tr>
        </table>

        <div class="charts" style="margin-top:18px">
          <div style="width:48%"><canvas id="chartRevenue"></canvas><button class="btn" id="dlRev" style="margin-top:8px">Télécharger CA PNG</button></div>
          <div style="width:48%"><canvas id="chartProduction"></canvas><button class="btn" id="dlProd" style="margin-top:8px">Télécharger Prod PNG</button></div>
        </div>
      </div>
    </div>
  </section>

  <!-- MODELES (onglets) -->
  <section id="modeles" class="slide">
    <div class="container">
      <div class="card">
        <h2>Modèles Tesla — onglets</h2>

        <div class="tabs" role="tablist" aria-label="Modèles Tesla">
          <div class="tab-btn active" data-tab="tab-roadster">Roadster</div>
          <div class="tab-btn" data-tab="tab-models">Model S</div>
          <div class="tab-btn" data-tab="tab-model3">Model 3</div>
          <div class="tab-btn" data-tab="tab-modelx">Model X</div>
          <div class="tab-btn" data-tab="tab-modely">Model Y</div>
          <div class="tab-btn" data-tab="tab-cyber">Cybertruck</div>
          <div class="tab-btn" data-tab="tab-semi">Semi</div>
        </div>

        <!-- tab panels -->
        <div id="tab-roadster" class="tab-panel active">
          <div class="specs">
            <img src="roadster.jpg" alt="Roadster" style="max-width:420px;margin-bottom:10px" />
            <div style="max-width:560px;text-align:left">
              <h3>Roadster (2008 / futur)</h3>
              <p>Le Roadster est le premier véhicule de Tesla ; il prouve que l’électrique peut être performant et désirable. Tesla a annoncé une nouvelle génération du Roadster avec des performances extrêmes.</p>
              <ul>
                <li>Type : Sportive 2 places</li>
                <li>Autonomie (selon versions) : > 300 km (anc.), objectifs > 600 km (future)</li>
              </ul>
            </div>
          </div>
        </div>

        <div id="tab-models" class="tab-panel">
          <div class="specs">
            <img src="modelS.jpg" alt="Model S" />
            <div style="max-width:560px;text-align:left">
              <h3>Model S</h3>
              <p>Berline premium 4-5 places, reconnue pour son autonomie, accélération et confort. Elle intègre des mises à jour logicielles OTA et des fonctionnalités de conduite assistée.</p>
              <ul>
                <li>Puissance : très élevée pour les versions « Plaid »</li>
                <li>Autonomie : parmi les meilleures du marché</li>
              </ul>
            </div>
          </div>
        </div>

        <div id="tab-model3" class="tab-panel">
          <div class="specs">
            <img src="model3.jpg" alt="Model 3" />
            <div style="max-width:560px;text-align:left">
              <h3>Model 3</h3>
              <p>Modèle d'entrée de gamme (relative) devenu best-seller : compact, performant et abordable comparé aux autres Tesla, avec une excellente efficience.</p>
              <ul><li>Rapport qualité/prix</li><li>Large diffusion mondiale</li></ul>
            </div>
          </div>
        </div>

        <div id="tab-modelx" class="tab-panel">
          <div class="specs">
            <img src="modelX.jpg" alt="Model X" />
            <div style="max-width:560px;text-align:left">
              <h3>Model X</h3>
              <p>SUV premium avec portes "Falcon Wing", offrant volume et sécurité ; souvent choisi par familles recherchant espace et performances.</p>
            </div>
          </div>
        </div>

        <div id="tab-modely" class="tab-panel">
          <div class="specs">
            <img src="modelY.jpg" alt="Model Y" />
            <div style="max-width:560px;text-align:left">
              <h3>Model Y</h3>
              <p>Crossover compact, meilleur compromis pour beaucoup de clients : polyvalent, spacieux et performant.</p>
            </div>
          </div>
        </div>

        <div id="tab-cyber" class="tab-panel">
          <div class="specs">
            <img src="cybertruck.jpg" alt="Cybertruck" />
            <div style="max-width:560px;text-align:left">
              <h3>Cybertruck</h3>
              <p>Pick-up au design radical, conçu pour durabilité et capacité de charge. Très médiatisé, produit en volumes croissants.</p>
            </div>
          </div>
        </div>

        <div id="tab-semi" class="tab-panel">
          <div class="specs">
            <img src="semi.jpg" alt="Semi" />
            <div style="max-width:560px;text-align:left">
              <h3>Semi</h3>
              <p>Camion électrique pour transport longue-distance, visant la réduction des coûts logistiques et des émissions sur le transport routier.</p>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- USINES / CARTE -->
  <section id="usines" class="slide">
    <div class="container">
      <div class="card">
        <h2>Gigafactories & Implantations</h2>
        <p style="color:#cfeef2">Les principales usines de Tesla dans le monde : Fremont (USA), Nevada (USA), Texas (USA), Shanghai (Chine), Berlin (Allemagne), et d'autres en projet.</p>
        <div id="map" aria-label="Carte des usines Tesla"></div>
        <div style="margin-top:14px;color:#d6eef3">
          Cliquez sur les marqueurs pour voir la ville et la spécialité de chaque usine.
        </div>
      </div>
    </div>
  </section>

  <!-- CONCLUSION (longue) -->
  <section id="conclusion" class="slide">
    <div class="container">
      <div class="card">
        <h2>Conclusion — Impact & Avenir (développé)</h2>

        <p style="color:#d6eef3">
          Tesla a démontré qu’une entreprise pouvait à la fois innover techniquement et remodeler un marché global. 
          En partant d’un concept — une voiture électrique désirable — Tesla a étendu son champ d'action à l’énergie (batteries et solaire), 
          aux logiciels (mise à jour OTA, conduite assistée) et même à la robotique (projets Optimus).
        </p>

        <p style="color:#d6eef3">
          L’impact de Tesla est multiple : d’une part il accélère la transition vers des véhicules propres et une production d’énergie décarbonée ; 
          d’autre part il impose de nouveaux standards (intégration verticale, logiciel embarqué, expérience utilisateur). 
          Les perspectives futures incluent des réseaux de stockage massifs, la robotique appliquée à l’industrie, et potentiellement des changements structurants 
          dans la mobilité (robotaxis, flottes autonomes).
        </p>

        <p style="color:#d6eef3">
          Limites et défis : Tesla fait face à la concurrence croissante, aux défis de montée en production, aux questions réglementaires concernant la conduite autonome, 
          et aux enjeux sociétaux (emplois, sécurité). Malgré cela, la capacité d’exécution et l’ambition technologique de Tesla en font un acteur incontournable.
        </p>

        <p style="color:#d6eef3;font-weight:700;margin-top:8px">
          En résumé : Tesla ne fabrique pas seulement des voitures ; elle influence la manière dont le monde produit, stocke et consomme l'énergie. 
          Pour nous (1ère STMG), c’est un exemple concret de stratégie d’entreprise, d’innovation produit et d’impact économique mondial.
        </p>

      </div>
    </div>
  </section>

  <!-- SOURCES -->
  <section id="sources" class="slide">
    <div class="container">
      <div class="card">
        <h2>Sources & Références</h2>
        <ul style="text-align:left;color:#cfeef2">
          <li>Tesla (site officiel) — tesla.com</li>
          <li>Rapports annuels / filings (Tesla Inc.)</li>
          <li>Wikimedia Commons (images libres)</li>
          <li>Articles économiques et presse spécialisée (ex. Financial Times, Reuters)</li>
        </ul>
        <p style="color:#bcdedf;font-size:13px;margin-top:8px">Remarque : pour diffusion publique, vérifie les droits des images ; ici les images sont attendues dans ton dépôt pour usage de présentation.</p>
      </div>
    </div>
  </section>

</main>

<!-- Modal (image + texte) -->
<div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="close-x" role="button" aria-label="fermer" onclick="closeModal()">✕</div>
  <div class="box">
    <h3 id="modalTitle" style="margin-top:0;color:#fff"></h3>
    <img id="modalImg" src="" alt="" />
    <p id="modalText" style="color:#d6eef3;margin-top:12px"></p>
  </div>
</div>

<!-- Footer -->
<footer class="sitefoot">
  <div>Projet réalisé par Mohammed, Dragos, Kely & Noah — 1ère STMG</div>
  <div style="margin-top:6px;font-size:13px">Tous droits réservés — présentation pédagogique</div>
</footer>

<!-- Scripts : Leaflet + Chart.js already linked above; now main JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
/* --------------------------
   Helper: reveal animations (fade on scroll)
   -------------------------- */
function revealOnScroll(){
  document.querySelectorAll('.card, .gallery img, .hero .lead').forEach(el=>{
    const rect = el.getBoundingClientRect();
    if(rect.top < window.innerHeight - 80){
      el.style.opacity = 1;
      el.style.transform = 'none';
    } else {
      el.style.opacity = 0.0;
      el.style.transform = 'translateY(18px)';
    }
  });
}
window.addEventListener('scroll', revealOnScroll);
window.addEventListener('load', function(){
  // initial relax
  document.querySelectorAll('.card').forEach(c=>{c.style.opacity=0; c.style.transform='translateY(18px)';});
  setTimeout(revealOnScroll,200);
});

/* --------------------------
   Tabs logic for models
   -------------------------- */
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click', function(){
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
    btn.classList.add('active');
    const id = btn.getAttribute('data-tab');
    const panel = document.getElementById(id);
    if(panel) panel.classList.add('active');
    // scroll gently to models
    document.getElementById('modeles').scrollIntoView({behavior:'smooth'});
  });
});
// activate first panel (roadster) by default
document.querySelectorAll('.tab-panel').forEach((p,i)=>{ if(i===0) p.classList.add('active'); });

/* --------------------------
   Modal open for gallery images / model images
   -------------------------- */
function openModal(title, imgSrc, text){
  document.getElementById('modalTitle').innerText = title || '';
  document.getElementById('modalImg').src = imgSrc || '';
  document.getElementById('modalText').innerText = text || '';
  const modal = document.getElementById('modal');
  modal.style.display = 'flex';
  modal.setAttribute('aria-hidden','false');
}
function closeModal(){
  const modal = document.getElementById('modal');
  modal.style.display = 'none';
  modal.setAttribute('aria-hidden','true');
}
document.querySelectorAll('.gallery img, .parallax, .card img').forEach(img=>{
  img.addEventListener('click', (e)=>{
    const src = e.currentTarget.getAttribute('src');
    const alt = e.currentTarget.getAttribute('alt') || '';
    openModal(alt, src, 'Cliquer en dehors de l’image ou sur ✕ pour fermer.');
  });
});

/* --------------------------
   Charts (Chart.js) - Revenue & Production
   -------------------------- */
// revenue chart (line)
const revCtx = document.getElementById('chartRevenue').getContext('2d');
const chartRevenue = new Chart(revCtx, {
  type:'line',
  data:{
    labels: ['2018','2019','2020','2021','2022','2023'],
    datasets:[{
      label:'Chiffre d\'affaires (Mds $)',
      data:[21,24,31,53,81,96],
      borderColor: 'rgba(232,33,39,0.95)',
      backgroundColor: 'rgba(232,33,39,0.12)',
      tension:0.3,
      pointRadius:4
    }]
  },
  options:{
    responsive:true,
    plugins:{legend:{labels:{color:'#fff'}}},
    scales:{
      x:{ticks:{color:'#ddd'}},
      y:{ticks:{color:'#ddd'}}
    }
  }
});

// production chart (bar)
const prodCtx = document.getElementById('chartProduction').getContext('2d');
const chartProduction = new Chart(prodCtx, {
  type:'bar',
  data:{
    labels:['2018','2019','2020','2021','2022','2023'],
    datasets:[{
      label:'Production (milliers véhicules)',
      data:[245,365,500,930,1313,1845],
      backgroundColor:'rgba(0,196,154,0.9)',
      borderRadius:6
    }]
  },
  options:{
    responsive:true,
    plugins:{legend:{labels:{color:'#fff'}}},
    scales:{x:{ticks:{color:'#ddd'}},y:{ticks:{color:'#ddd'}}}
  }
});

// export buttons
document.getElementById('dlRev').addEventListener('click', ()=>{
  const a = document.createElement('a');
  a.href = document.getElementById('chartRevenue').toDataURL('image/png');
  a.download = 'tesla_revenue.png'; a.click();
});
document.getElementById('dlProd').addEventListener('click', ()=>{
  const a = document.createElement('a');
  a.href = document.getElementById('chartProduction').toDataURL('image/png');
  a.download = 'tesla_production.png'; a.click();
});

/* --------------------------
   Leaflet map: Gigafactories markers with info
   -------------------------- */
const map = L.map('map', {scrollWheelZoom:false}).setView([25, 0], 2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

const factories = [
  {name:'Fremont (California, USA)', lat:37.4845, lon:-122.1484, info:'Production de véhicules (Model S,3,X,Y...)'},
  {name:'Gigafactory Nevada (USA)', lat:39.5309, lon:-119.8144, info:'Batteries & composants'},
  {name:'Gigafactory Texas (USA)', lat:30.2157, lon:-97.4510, info:'Production Model Y, Cybertruck assembly'},
  {name:'Gigafactory Shanghai (China)', lat:31.1915, lon:121.4238, info:'Production locale pour Asie; exportation'},
  {name:'Gigafactory Berlin (Germany)', lat:52.3996, lon:13.2430, info:'Production pour Europe & batteries'}
];

factories.forEach(f=>{
  L.marker([f.lat,f.lon]).addTo(map).bindPopup(`<strong>${f.name}</strong><br>${f.info}`);
});

/* --------------------------
   Accessibility small helpers
   -------------------------- */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape') closeModal();
});

/* finalize: ensure maps invalidate size after load to show correctly */
setTimeout(()=>{ map.invalidateSize(); }, 300);

</script>
</body>
</html>
